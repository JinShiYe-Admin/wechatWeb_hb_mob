<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>成员</title>
		<script type="text/javascript">
			var WebVersion = "?" + Math.random();
		</script>
		<link rel="stylesheet" href="../../../css/weui.min.css" />
		<link rel="stylesheet" href="../../../js/demoCssJs/jquery-weui.min.css" />
		<link rel="stylesheet" href="../../../js/demoCssJs/demos.css" />
	</head>

	<body>
		<script type="text/javascript" src="../../../js/lib/vconsole/vconsole.min.js"></script>
		<script type="text/javascript" src="../../../js/demoCssJs/jquery-2.1.4.js"></script>
		<script type="text/javascript" src="../../../js/demoCssJs/jquery-weui.min.js"></script>
		<script type="text/javascript">
			document.write("<s" + "cript type='text/javascript' src='../../../js/PublicProtocol.js" + WebVersion + "'></s" + "cript>");
			document.write("<s" + "cript type='text/javascript' src='../../../js/utils/utils.js" + WebVersion + "'></s" + "cript>");
			document.write("<s" + "cript type='text/javascript' src='../../../js/utils/storageutil.js" + WebVersion + "'></s" + "cript>");
			//document.write("<s" + "cript type='text/javascript' src='../../../temp/mineinfo.js" + WebVersion + "'></s" + "cript>");
		</script>
		<script type="text/javascript">
			var depId; //部门id
			var mineUserInfo; //个人信息
			window.onload = function() {
				var search = location.search.toString();
				var keyword = "?id=";
				var index = search.indexOf(keyword);
				var isChange = false; //是否是修改请假申请
				if(index != -1) {
					isChange = true;
					depId = search.substring(index + keyword.length);
					getMineInfo();
				} else {
					$.alert("未获取到有效的数据", "提示");
				}
				console.log("depId:" + depId);
			}
			/**
			 * 获取我的信息
			 */
			function getMineInfo() {
				var tempData = {
					cmd: 'userinfo',
					type: 'findpage',
					colv: ""
				}
				unitWebsitePro(tempData, function(data) {
					if(data.RspCode == 0) {
						mineUserInfo = JSON.parse(data.RspData);
						getMembers();
					} else {
						$.alert("未获取到个人信息(" + data.RspTxt + ")", "提示");
					}
				});
			}

			/**
			 * 获取成员
			 */
			function getMembers(){
				var tempData = {
					cmd: 'departpersons',
					type: 'findpage',
					colid:depId,
					colv: 0,
					callcol:"info"
				}
				unitWebsitePro(tempData, function(data) {
					if(data.RspCode == 0) {

					} else {
						//$.alert("未获取到成员信息(" + data.RspTxt + ")", "提示");
					}
				});
			}
		</script>
	</body>

</html>