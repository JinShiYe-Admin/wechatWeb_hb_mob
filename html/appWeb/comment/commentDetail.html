<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>学生点评</title>
		<script type="text/javascript">
			var WebVersion = "?" + Math.random();
		</script>
		<link rel="stylesheet" href="../../../css/weui.min.css" />
		<link rel="stylesheet" href="../../../css/classCircle/class_circle_home.css" />
		<link rel="stylesheet" href="../../../js/demoCssJs/jquery-weui.min.css" />
		<link rel="stylesheet" href="../../../js/demoCssJs/demos.css" />
		<style>
			.weui-panel {
				background-color: #FFFFFF;
				margin-top: 0px;
				position: relative;
				overflow: hidden;
			}
			
			.weui-grids {
				position: relative;
				overflow: hidden;
			}
			
			.weui-grids:before {
				content: " ";
				position: absolute;
				left: 0;
				top: 0;
				right: 0;
				height: 1px;
				border-top: 1px solid #FFFFFF;
				color: #FFFFFF;
				-webkit-transform-origin: 0 0;
				transform-origin: 0 0;
				-webkit-transform: scaleY(0.5);
				transform: scaleY(0.5);
			}
			
			.weui-grids:after {
				content: " ";
				position: absolute;
				left: 0;
				top: 0;
				width: 1px;
				bottom: 0;
				border-left: 1px solid #FFFFFF;
				color: #FFFFFF;
				-webkit-transform-origin: 0 0;
				transform-origin: 0 0;
				-webkit-transform: scaleX(0.5);
				transform: scaleX(0.5);
			}
			
			.weui-grid {
				position: relative;
				float: left;
				padding: 5px 5px;
				width: 33.33333333%;
				box-sizing: border-box;
			}
			
			.weui-grid:before {
				content: " ";
				position: absolute;
				right: 0;
				top: 0;
				width: 1px;
				bottom: 0;
				border-right: 1px solid #FFFFFF;
				color: #FFFFFF;
				-webkit-transform-origin: 100% 0;
				transform-origin: 100% 0;
				-webkit-transform: scaleX(0.5);
				transform: scaleX(0.5);
			}
			
			.weui-grid:after {
				content: " ";
				position: absolute;
				left: 0;
				bottom: 0;
				right: 0;
				height: 1px;
				border-bottom: 1px solid #FFFFFF;
				color: #FFFFFF;
				-webkit-transform-origin: 0 100%;
				transform-origin: 0 100%;
				-webkit-transform: scaleY(0.5);
				transform: scaleY(0.5);
			}
			
			.weui-grid__icon {
				width: 100%;
				height: 100%;
				margin: 0 auto;
			}
			
			.weui-grid:active {
				background-color: #FFFFFF;
			}
		</style>
	</head>

	<body>
		<div id="list" class="page__bd">
			<div class="weui-panel weui-panel_access" v-for="(item,index) in datasource">
				<div class="weui-panel__bd">
					<template v-if="item.EvalType==3">
						<a href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg">
							<div class="weui-media-box__hd">
								<img class="weui-media-box__thumb" :src="item.BeEvalManAvatar" style="border-radius: 50px;" alt="">
							</div>
							<div class="weui-media-box__bd">
								<h4 class="weui-media-box__title">{{item.BeEvalManName}}</h4>
								<p class="weui-media-box__desc">{{item.EvalTime}}</p>
							</div>
						</a>
						<p style="margin-left: 10px;">{{item.EvalContent}}</p>
						<div class="weui-grids">
							<a href="javascript:;" class="weui-grid">
								<div class="weui-grid__icon">
									<img :src="item.EvalEncThumb" alt="">
								</div>
							</a>
						</div>
						<br />
					</template>
					<template v-else>
						<a href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg">
							<div class="weui-media-box__hd">
								<img class="weui-media-box__thumb" :src="item.EvalEncThumb" alt="" style="border-radius: 50px;">
							</div>
							<div class="weui-media-box__bd">
								<h4 class="weui-media-box__title">+1分<span style="color:black;">{{" "+item.EvalContent}}</span></h4>
								<p class="weui-media-box__desc">{{item.EvalTime+" 由"+item.EvalManName+"点评"}}</p>
							</div>
						</a>

					</template>
					
				</div>
			</div>
		</div>
		<script src="../../../js/vue.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="../../../js/lib/vconsole/vconsole.min.js"></script>
		<script type="text/javascript" src="../../../js/demoCssJs/jquery-2.1.4.js"></script>
		<script type="text/javascript" src="../../../js/demoCssJs/jquery-weui.min.js"></script>
		<script type="text/javascript">
			document.write("<s" + "cript type='text/javascript' src='../../../js/PublicProtocol.js" + WebVersion + "'></s" + "cript>");
			document.write("<s" + "cript type='text/javascript' src='../../../js/utils/utils.js" + WebVersion + "'></s" + "cript>");
			document.write("<s" + "cript type='text/javascript' src='../../../js/utils/storageutil.js" + WebVersion + "'></s" + "cript>");
			//document.write("<s" + "cript type='text/javascript' src='../../../temp/mineinfo.js" + WebVersion + "'></s" + "cript>");
		</script>
		<script>
			var loading = false; //下拉状态标记
			var mineUserInfo; //个人信息

			var vm = new Vue({
				el: '#list',
				data: {
					datasource: []
				},
				updated: function() {
					//					console.log(JSON.stringify(vm.datasource));
					console.log(document.getElementById("list").innerHTML);
				}

			})
			 var deptId;
			 var deptName;
			 var mineUserInfo;
			window.onload = function() {
				var sValue = utils.getSessionStorageByUrlsKey();
				deptId = sValue.deptId;
				deptName = sValue.deptName;
				mineUserInfo = sValue.mineUserInfo;
				//				$.showLoading();
				getEvaluation();
				//				getMineInfo();
			}

			function initListener() {}
			/**
			 * 获取我的信息
			 */
			function getMineInfo() {
				var tempData = {
					cmd: 'userinfo',
					type: 'findpage',
					colv: ""
				}
				unitWebsitePro(tempData, function(data) {
					//data = getMineInfoCallBack;
					if(data.RspCode == 0) {
						mineUserInfo = JSON.parse(data.RspData);
					} else {
						$.hideLoading();
						$.alert("未获取到个人信息(" + data.RspTxt + ")", "提示");
					}
				});
			}

			function getEvaluation() {
				var tempData = {
					corpId:mineUserInfo.corpid,
					deptId:deptId,
					userId:mineUserInfo.userid,
//					corpId: 'wx6c4528c675d4a9c9',
//					deptId: 11,
//					userId: "moshanglin",
					pageIndex: 1,
					pageSize: 20,
				}
				console.log("点评列表参数："+JSON.stringify(tempData));
				getEvaluationPro(tempData, function(data) {
					console.log("点评列表数据："+JSON.stringify(data));
					vm.datasource = data.RspData.Data;
				});
			}
		</script>
	</body>

</html>