<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>课程表管理</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="../../css/utils/pullToRefresh.css" />

	</head>

	<body>
		<div class="mui-content mui-scroll-wrapper" style="z-index: 1;" id="schedule">
			<div class="mui-scroll">

				<!--列表信息流 开始-->
				<ul id="list" class="mui-table-view">
					<li class="mui-table-view-cell mui-media" v-on:tap=clickItem()>
						<div class="mui-media-body" style="margin-top: 10px;">
							添加课程表
						</div>
					</li>
					<li class="mui-table-view-divider">现有课程表</li>
					<li class="mui-table-view-cell mui-media" v-for="item in items">
						<a href="javascript:;" v-on:tap=clickItem(item)>
							<div id="">
								{{item.edulename+item.departname+item.timespanb+"到"+item.timespane}}
							</div>

						</a>
					</li>
				</ul>
				<!--列表信息流 结束-->
			</div>
		</div>

		<script src="../../js/mui.min.js"></script>
		<script src="../../js/vue.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="../../js/utils/mui.pullToRefresh.js"></script>
		<script type="text/javascript" src="../../js/utils/mui.pullToRefresh.material.js"></script>
		<script type="text/javascript">
			document.write("<s" + "cript type='text/javascript' src='../../js/importJS.js?" + Math.random() + "'></s" + "cript>");
		</script>
		<script type="text/javascript">
			mui.init();
			var schedulePage = 1; //获取的新闻页码
			var scheduleFlag = 0; //0刷新，1加载更多
			var chnid;
			var schedule = new Vue({
				el: '#schedule',
				data: {
					items: [] //列表信息流数据
				},
				methods: {
					clickItem: function(item) {
						if(item == undefined) {
							console.log(123)
							item = {
								flag: 0
							}
						} else {
							item.flag = 1;
						}

						utils.wOpenWithData("subject_timetable.html", item);
					}
				}
			});
			getscheduleList()

			//获取课程表列表
			function getscheduleList() {
				var tempData = {
					cmd: 'edule', //文章管理
					type: 'findpage', //分页查找文章列表
					pagesize: '10', //每页条数
					pageindex: schedulePage, //页码

				}
				unitWebsitePro(tempData, function(data) {
					if(data.RspCode == 0) {
						if(data.RspData.dt.length > 0) {
							//判断是刷新0，还是加载更多1
							if(scheduleFlag == 0) {
								schedule.items = data.RspData.dt;
							} else {
								schedule.items = schedule.items.concat(data.RspData.dt);
							}
						}
						schedulePage++;
					} else {
						alert(data.RspTxt);
					}
				});
			}
//			addEdule();
editEdule();
//		deleteEdule();
		function editEdule() {
			var tempData = {
					cmd: 'edule',
					type: 'edit',
					callcol:'edulename',
					colid:32,
					colv:"修改名称成功"
				}
			unitWebsitePro(tempData, function(data) {
					if(data.RspCode == 0) {
						console.log("修改名称成功")
					} else {
						alert(data.RspTxt);
					}
				});
		}
		function deleteEdule() {
			var tempData = {
					cmd: 'edule',
					type: 'del',
					colid:33
				}
			unitWebsitePro(tempData, function(data) {
					if(data.RspCode == 0) {
						console.log("删除成功")
					} else {
						alert(data.RspTxt);
					}
				});
		}

			function addEdule() {
				var tempData = {
					cmd: 'edule',
					type: 'add',
					edulename: "夏季课程表",
					departid: 11,
					departname: "开发部",
					timespanb: '201707',
					timespane: '201709',
					edulerows: [{
						timespan: "09:00-10:00",
						daytype: "下午",
						orderid: 1,
						monsub: 5,
						monsubname: "物理",
						monuid: "moshanglin",
						monuname: "莫尚林",
						tuessub: 5,
						tuessubname: "物理",
						tuesuid: "moshanglin",
						tuesuname: "莫尚林",
						wedsub: 5,
						wedsubname: "物理",
						weduid: "moshanglin",
						weduname: "莫尚林",
						thursub: 5,
						thursubname: "物理",
						thuruid: "moshanglin",
						thuruname: "莫尚林",
						frisub: 5,
						frisubname: "物理",
						friuid: "moshanglin",
						friuname: "莫尚林",
						satsub: 5,
						satsubname: "物理",
						satuid: "moshanglin",
						satuname: "莫尚林",
						sunsub: 5,
						sunsubname: "物理",
						sunuid: "moshanglin",
						sununame: "莫尚林",
					}, {
						timespan: "09:00-10:00",
						daytype: "下午",
						orderid: 2,
						monsub: 5,
						monsubname: "物理",
						monuid: "moshanglin",
						monuname: "莫尚林",
						tuessub: 5,
						tuessubname: "物理",
						tuesuid: "moshanglin",
						tuesuname: "莫尚林",
						wedsub: 5,
						wedsubname: "物理",
						weduid: "moshanglin",
						weduname: "莫尚林",
						thursub: 5,
						thursubname: "物理",
						thuruid: "moshanglin",
						thuruname: "莫尚林",
						frisub: 5,
						frisubname: "物理",
						friuid: "moshanglin",
						friuname: "莫尚林",
						satsub: 5,
						satsubname: "物理",
						satuid: "moshanglin",
						satuname: "莫尚林",
						sunsub: 5,
						sunsubname: "物理",
						sunuid: "moshanglin",
						sununame: "莫尚林",
					}, {
						timespan: "09:00-10:00",
						daytype: "下午",
						orderid: 3,
						monsub: 5,
						monsubname: "物理",
						monuid: "moshanglin",
						monuname: "莫尚林",
						tuessub: 5,
						tuessubname: "物理",
						tuesuid: "moshanglin",
						tuesuname: "莫尚林",
						wedsub: 5,
						wedsubname: "物理",
						weduid: "moshanglin",
						weduname: "莫尚林",
						thursub: 5,
						thursubname: "物理",
						thuruid: "moshanglin",
						thuruname: "莫尚林",
						frisub: 5,
						frisubname: "物理",
						friuid: "moshanglin",
						friuname: "莫尚林",
						satsub: 5,
						satsubname: "物理",
						satuid: "moshanglin",
						satuname: "莫尚林",
						sunsub: 5,
						sunsubname: "物理",
						sunuid: "moshanglin",
						sununame: "莫尚林",
					}, {
						timespan: "09:00-10:00",
						daytype: "下午",
						orderid: 4,
						monsub: 5,
						monsubname: "物理",
						monuid: "moshanglin",
						monuname: "莫尚林",
						tuessub: 5,
						tuessubname: "物理",
						tuesuid: "moshanglin",
						tuesuname: "莫尚林",
						wedsub: 5,
						wedsubname: "物理",
						weduid: "moshanglin",
						weduname: "莫尚林",
						thursub: 5,
						thursubname: "物理",
						thuruid: "moshanglin",
						thuruname: "莫尚林",
						frisub: 5,
						frisubname: "物理",
						friuid: "moshanglin",
						friuname: "莫尚林",
						satsub: 5,
						satsubname: "物理",
						satuid: "moshanglin",
						satuname: "莫尚林",
						sunsub: 5,
						sunsubname: "物理",
						sunuid: "moshanglin",
						sununame: "莫尚林",
					}, {
						timespan: "09:00-10:00",
						daytype: "下午",
						orderid: 5,
						monsub: 5,
						monsubname: "物理",
						monuid: "moshanglin",
						monuname: "莫尚林",
						tuessub: 5,
						tuessubname: "物理",
						tuesuid: "moshanglin",
						tuesuname: "莫尚林",
						wedsub: 5,
						wedsubname: "物理",
						weduid: "moshanglin",
						weduname: "莫尚林",
						thursub: 5,
						thursubname: "物理",
						thuruid: "moshanglin",
						thuruname: "莫尚林",
						frisub: 5,
						frisubname: "物理",
						friuid: "moshanglin",
						friuname: "莫尚林",
						satsub: 5,
						satsubname: "物理",
						satuid: "moshanglin",
						satuname: "莫尚林",
						sunsub: 5,
						sunsubname: "物理",
						sunuid: "moshanglin",
						sununame: "莫尚林",
					}, {
						timespan: "09:00-10:00",
						daytype: "下午",
						orderid: 6,
						monsub: 5,
						monsubname: "物理",
						monuid: "moshanglin",
						monuname: "莫尚林",
						tuessub: 5,
						tuessubname: "物理",
						tuesuid: "moshanglin",
						tuesuname: "莫尚林",
						wedsub: 5,
						wedsubname: "物理",
						weduid: "moshanglin",
						weduname: "莫尚林",
						thursub: 5,
						thursubname: "物理",
						thuruid: "moshanglin",
						thuruname: "莫尚林",
						frisub: 5,
						frisubname: "物理",
						friuid: "moshanglin",
						friuname: "莫尚林",
						satsub: 5,
						satsubname: "物理",
						satuid: "moshanglin",
						satuname: "莫尚林",
						sunsub: 5,
						sunsubname: "物理",
						sunuid: "moshanglin",
						sununame: "莫尚林",
					}, {
						timespan: "09:00-10:00",
						daytype: "下午",
						orderid: 7,
						monsub: 5,
						monsubname: "物理",
						monuid: "moshanglin",
						monuname: "莫尚林",
						tuessub: 5,
						tuessubname: "物理",
						tuesuid: "moshanglin",
						tuesuname: "莫尚林",
						wedsub: 5,
						wedsubname: "物理",
						weduid: "moshanglin",
						weduname: "莫尚林",
						thursub: 5,
						thursubname: "物理",
						thuruid: "moshanglin",
						thuruname: "莫尚林",
						frisub: 5,
						frisubname: "物理",
						friuid: "moshanglin",
						friuname: "莫尚林",
						satsub: 5,
						satsubname: "物理",
						satuid: "moshanglin",
						satuname: "莫尚林",
						sunsub: 5,
						sunsubname: "物理",
						sunuid: "moshanglin",
						sununame: "莫尚林",
					}, {
						timespan: "09:00-10:00",
						daytype: "下午",
						orderid: 8,
						monsub: 5,
						monsubname: "物理",
						monuid: "moshanglin",
						monuname: "莫尚林",
						tuessub: 5,
						tuessubname: "物理",
						tuesuid: "moshanglin",
						tuesuname: "莫尚林",
						wedsub: 5,
						wedsubname: "物理",
						weduid: "moshanglin",
						weduname: "莫尚林",
						thursub: 5,
						thursubname: "物理",
						thuruid: "moshanglin",
						thuruname: "莫尚林",
						frisub: 5,
						frisubname: "物理",
						friuid: "moshanglin",
						friuname: "莫尚林",
						satsub: 5,
						satsubname: "物理",
						satuid: "moshanglin",
						satuname: "莫尚林",
						sunsub: 5,
						sunsubname: "物理",
						sunuid: "moshanglin",
						sununame: "莫尚林",
					}, {
						timespan: "09:00-10:00",
						daytype: "下午",
						orderid: 9,
						monsub: 5,
						monsubname: "物理",
						monuid: "moshanglin",
						monuname: "莫尚林",
						tuessub: 5,
						tuessubname: "物理",
						tuesuid: "moshanglin",
						tuesuname: "莫尚林",
						wedsub: 5,
						wedsubname: "物理",
						weduid: "moshanglin",
						weduname: "莫尚林",
						thursub: 5,
						thursubname: "物理",
						thuruid: "moshanglin",
						thuruname: "莫尚林",
						frisub: 5,
						frisubname: "物理",
						friuid: "moshanglin",
						friuname: "莫尚林",
						satsub: 5,
						satsubname: "物理",
						satuid: "moshanglin",
						satuname: "莫尚林",
						sunsub: 5,
						sunsubname: "物理",
						sunuid: "moshanglin",
						sununame: "莫尚林",
					}]

				}
				unitWebsitePro(tempData, function(data) {
					console.log('添加课程表:' + JSON.stringify(data));
					if(data.RspCode == 0) {} else {
						mui.toast(data.RspTxt)
					}
				})

			}

			function addpullRefresh() {
				var pullRefresh = mui('.mui-scroll-wrapper .mui-scroll').pullToRefresh({
					down: {
						callback: function() {
							console.log('down');
							setTimeout(function() {
								scheduleFlag = 0; //0刷新，1加载更多
								schedulePage = 0;
								getscheduleList();
								pullRefresh.endPullDownToRefresh(); //结束下拉刷新
							}, 1000);
						}
					},
					up: {
						callback: function() {
							console.log('up');
							setTimeout(function() {
								scheduleFlag = 1; //0刷新，1加载更多
								getscheduleList();
								pullRefresh.endPullUpToRefresh();
							}, 1000);
						}
					}
				});
			}
		</script>
	</body>

</html>