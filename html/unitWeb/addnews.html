<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<title>新闻添加</title>
		<link rel="stylesheet" href="../../css/weui.min.css" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<style>
 
           .dropdown:before, .dropdown:after {
             content: '';
             position: absolute;
             z-index: 20; top: 18px;
             right: 10px; border: 4px dashed;
             border-color: #888888 transparent;}

           .dropdown:before {
             border-bottom-style: solid;
             border-top: none;}

           .dropdown:after {
             margin-top: 7px;
             border-top-style: solid;
             border-bottom: none;}

           .dropdown-select:focus {
             z-index: 6; width: 100%;
             color: #394349;outline: 10px solid #49aff2;
             outline: 2px solid -webkit-focus-ring-color;
             outline-offset: -2px;}

           .dropdown-select > option {
             margin: 10px;
             padding: 10px 50px;
             text-shadow: none;
             background:#FFFFFF;
             border-radius: 200px;
             cursor: pointer;}

           .lt-ie9 .dropdown {z-index: 1;}
           .lt-ie9 .dropdown-select { z-index: -1;}
           .lt-ie9 .dropdown-select:focus {z-index: 3;}
           @-moz-document url-prefix() {.dropdown-select {padding-left: 6px;}}

           .dropdown-dark {
             background: #444;border-color: #111111 #0a0a0a black;
             background-image: -webkit-linear-gradient(top, transparent, rgba(0, 0, 0, 0.4));
             background-image: -moz-linear-gradient(top, transparent, rgba(0, 0, 0, 0.4));
             background-image: -o-linear-gradient(top, transparent, rgba(0, 0, 0, 0.4));
             background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.4));
             -webkit-box-shadow: inset 0 1px rgba(255, 255, 255, 0.1), 0 1px 1px rgba(0, 0, 0, 0.2);
             box-shadow: inset 0 1px rgba(255, 255, 255, 0.1), 0 1px 1px rgba(0, 0, 0, 0.2);}

           .dropdown-dark:before {border-bottom-color: #aaa;}
           .dropdown-dark:after {border-top-color: #aaa;}
           .dropdown-dark .dropdown-select {color: #aaa;text-shadow: 0 1px black;
             background: #444;  /* Fallback for IE 8 */}
           .dropdown-dark .dropdown-select:focus {color: #ccc;}
           .dropdown-dark .dropdown-select > option {background: #444;
             text-shadow: 0 1px rgba(0, 0, 0, 0.4);}
           .weui-cells { margin-top: 0px;}	
		   .weui-cells__title {color: black;}
		</style>
	</head>

	<body>
		<div id="conetent" class="weui-cells weui-cells_form">
			<div id="input_list">
			<div>
					<div class="weui-cells__title">所属栏目</div>
					<div class="weui-cells">
					 <div>
				<section class="container">
                    <div class="dropdown">
                      <select name="one"  id="chnid" class="dropdown-select" style="font-size: 17px;color: #929292;">
                      <option value="" >请选择所属栏目....</option>
                      <option value="{{value.id}}" v-for="(value,index) in inputArray">{{value.name}}</option>
                      </select>
                    </div>
                </select>
			</div>
			</div>
		   </div>
	 	 
				
			<!--输入列表-->
				<div>
					<div class="weui-cells__title">{{cname.title}}</div>
					<div class="weui-cells">
						<div class="weui-cell">
							<div class="weui-cell__bd">
								<input id="cname" v-model.lazy="cname.message" class="weui-input" type="text" :placeholder="'请输入'+cname.title">
							</div>
						</div>
					</div>
				</div>
				
				<div>
					<div class="weui-cells__title">{{newscontent.title}}</div>
					<div class="weui-cells">
						<div class="weui-cell">
							<div class="weui-cell__bd">
								
								<textarea id="conten"  v-model.lazy="newscontent.message"  class="weui-input" placeholder="请输入新闻内容"  style="border-color: white;height: 10rem;"></textarea>
							</div>
						</div>
					</div>
				</div>
				
				<div>
					<div class="weui-cells__title">{{newszy.title}}</div>
					  <div class="weui-cells">
						<div class="weui-cell">
							<div class="weui-cell__bd">
								<input id="summas" v-model.lazy="newszy.message" class="weui-input" type="text" :placeholder="'请输入'+newszy.title">
							</div>
						</div>
					</div>
				</div>
			</div>
			<!--开关列表-->
			<div id="switch_list">
			    <div>
					<div class="weui-cell weui-cell_switch">
						<div class="weui-cell__bd">{{islink.title}}</div>
						<div class="weui-cell__ft">
							<input id="islink" class="weui-switch" type="checkbox" v-model="islink.check">
						</div>
					</div>
				</div>
				<div v-if="islink.check">
					<div class="weui-cells">
						<div class="weui-cell">
							<div class="weui-cell__bd">
								<input id="quourl" v-model.lazy="linkurl.message" class="weui-input" type="text" :placeholder="'请输入'+linkurl.title">
							</div>
						</div>
					</div>
				</div>
                <div>
					<div class="weui-cell weui-cell_switch">
						<div class="weui-cell__bd">{{isReply.title}}</div>
						<div class="weui-cell__ft">
							<input id="isReply" class="weui-switch" type="checkbox" v-model="isReply.check">
						</div>
					</div>
				</div>
			 
			</div>
			<div class="weui-btn-area">
				<button id="submit" v-on:click="submitClick" class="weui-btn weui-btn_primary">{{editName}}</button>
			</div>
		</div>
		<script src="../../js/mui.min.js"></script>
		<script type="text/javascript" src="../../js/weui.min.js"></script>
		<script type="text/javascript" src="../../js/vue.min.js"></script>
		<script type="text/javascript" src="../../js/jweixin.js"></script>
		<script type="text/javascript" src="../../js/jquery.min.js"></script>
		<script type="text/javascript">
			document.write("<s" + "cript type='text/javascript' src='../../js/importJS.js?" + Math.random() + "'></s" + "cript>");
		</script>
		<script>
			window.onload = function() {
				var detail = utils.getDataFromUrl(window.location.href);
				vm.type = detail.type;
				if(vm.type == 'edit') {
					vm.editName = '确认'
					vm.chnid = detail.chnid;
					vm.cname.message = detail.cname;
					vm.orderid.message = detail.orderid;
					vm.linkurl.message = detail.linkurl;
					vm.islink.check = detail.islink;
					vm.iswrite.check = detail.iswrite;
					for(var item in vm.$data) {
						(function addwatch(key) {
							vm.$watch(key + '.message', function(newVal, oldVal) {
								edit(oldVal, newVal, key)
							})
						})(item)
					}
				} else {
					vm.editName = '添加'
				}
			}
			//所属栏目下拉框
			var vue_input = new Vue({
				el: '#chnid',
				data: {
					inputArray: [{
						name: "新闻动态",
						id:0
					}, {
						name: "师资力量",
						id:0
                   },{
						name: "学校简介",
						id:0}]
                    }
            });
			var vm = new Vue({
				el: '#conetent',
				data: {
					editName: '',
					cname: {
						title: "新闻标题",
						message: ""
					},
					newscontent: {
						title: "新闻内容",
						message: ""
					},
					newszy: {
						title: "新闻摘要",
						message: ""
					},
					linkurl: {
						title: "引用地址",
						message: ""
					}, 
					islink: {
						title: "是否为引用",
						check: true
					},
					isReply: {
						title: "是否允许回复",
						check: true
					},
					 
				},
				computed: {
					// a computed getter
					write: function() {
						return !this.islink.check
					}
				},
				methods: {
					submitClick: function() {
					}
				}
			})
            //按钮监听
            document.getElementById('submit').addEventListener('tap', function() {
            	var PriIsquo='';
            	var PriQuourl='';
            	var comData='';
            	var PriIsReply='';
            	var PriTopic = document.getElementById("cname").value;
            	var PriConten = document.getElementById("conten").value;
            	var PriSummas = document.getElementById("summas").value;
            	var Chnid = document.getElementById("chnid");
            	var PriChnid = Chnid.selectedIndex; // 选中索引
            	console.log('所属栏目=========================:' + PriChnid);
                    PriIsquo = document.getElementById("islink").checked==true ? 1 : 0;
            	    PriIsReply = document.getElementById("isReply").checked==true ? 1 : 0;
                if(PriIsquo==1 ){ 
                    PriQuourl = document.getElementById("quourl").value;
                    comData = {
					   topic: PriTopic,  
					   content: PriConten, 
					   summas: PriSummas,
				   	   isquo:PriIsquo,
					   quourl:PriQuourl,
					   isreply:PriIsReply
				    };
                 }else{ 
                  	comData = {
					   topic: PriTopic,  
					   content: PriConten, 
					   summas: PriSummas,
				   	   isquo:PriIsquo, 
					   isreply:PriIsReply
				    };
                 }
                 
                 unitWebsitePro(comData, function(data) {
					alert(data) 
					if(data.RspCode == 0) {
						//判断是刷新0，还是加载更多1
						newsColumn = data.RspData.dt;
				 		if(newsColumn.length > 0) {
						 	for(var item in newsColumn) {
								item.page = 1; //获取的新闻页码
								item.flag = 0; //0刷新，1加载更多
								item.newsArray = []; //存放当前的所有新闻数据
							} 
							chnIdIndex = 0;
							//生成所有栏目框架
							addCitiesSilders(newsColumn);
							initPullRefresh();
							getColumnNews(newsColumn[0]);
						} else {
							alert('暂时还没有lanm');
						}
					} else {
						alert(data.RspTxt);
					}
				});
                 
                 
				console.log('comData=========================:' + JSON.stringify(comData));
            });
		</script>
	</body>

</html>